---
title: "Lab 7 - Prediction and Bootstrapping"
categories: "Lab"
execute:
  eval: true
---

::: callout-important
This lab is due Monday 12th at 11:59pm.
:::


```{r}
library(tidyverse)
library(tidymodels)
library(dsbox)
```

https://datasciencebox.org/course-materials/hw-instructions/hw-09/hw-09-modeling-gss.html

# Instructions for project webpage compilation 


# Lab

# Data

The data can be found in the **dsbox** package, and it's called `gss16`.
Since the dataset is distributed with the package, we don't need to load it separately; it becomes available to us when we load the package.

You can find out more about the dataset by inspecting its documentation, which you can access by running `?gss16` in the Console or using the Help menu in RStudio to search for `gss16`.
You can also find this information [here](https://rstudio-education.github.io/dsbox/reference/gss16.html).


# Exercises

## Harassment at work: Exercise 1

a  Re-level the `advfront` variable such that it has two levels: `Strongly agree` and "`Agree"` combined into a new level called `agree` and the remaining levels (except `NA`s) combined into "`Not agree"`. Then, re-order the levels in the following order: `"Agree"` and `"Not agree"`. Finally, `count()` how many times each new level appears in the `advfront` variable.

```{marginfigure}
You can do this in various ways. One option is to use the `str_detect()` function to detect the existence of words. Note that these sometimes show up with lowercase first letters and sometimes with upper case first letters. To detect either in the `str_detect()` function, you can use "[Al]gree". However, solve the problem however you like, this is just one option!
```

b Combine the levels of the `polviews` variable such that levels that have the word "liberal" in them are lumped into a level called `"Liberal"` and those that have the word conservative in them are lumped into a level called `"Conservative"`. Then, re-order the levels in the following order: `"Conservative"` , `"Moderate"`, and `"Liberal"`. Finally, `count()` how many times each new level appears in the `polviews` variable.

c  Create a new data frame called `gss16_advfront` that includes the variables `advfront`, `educ`, `polviews`, and `wrkstat`. Then, use the `drop_na()` function to remove rows that contain `NA`s from this new data frame. Sample code is provided below.

```{r}
#|eval: false 
gss16_advfront <- gss16 %>%
  select(___, ___, ___, ___) %>%
  drop_na()
```

## Exercise 2

a Create a logistic regression model 

b Write out the estimated model 

c Prediction question 

## Exercise 3

a Fit a new model that adds an additional explanatory variable to the model fit in exercise 2 part a. 

b Make an argument for the "better" model between the one fit in exercise 2, and exercise 3. 


## Confidence Intervals- Exercise 4

In 2016, the GSS added a new question on harassment at work. The question is phrased as the following.

Over the past five years, have you been harassed by your superiors or co-workers at your job, for example, have you experienced any bullying, physical or psychological abuse?

Answers to this question are stored in the `harass5` variable in our dataset.

a Create a subset of the data that only contains `Yes` and `No` answers for the harassment question. How many responses chose each of these answers?

b Describe how bootstrapping can be used to estimate the proportion of Americans who have been harassed by their superiors or co-workers at their job.

c Calculate a 95% bootstrap confidence interval for the proportion of Americans who have been harassed by their superiors or co-workers at their job. Interpret this interval in context of the data.

## Exercise 5

a Where was your 95% confidence interval centered? Why does this make sense? 

b Now, calculate 90% bootstrap confidence interval for the proportion of Americans who have been harassed by their superiors or co-workers at their job. Report the interval below. Is it wider or more narrow than the 95% confidence interval? 

c Now, suppose you created a bootstrap distribution with 50,000 simulations instead of 10,000. What would you expect to change (if anything)?

- Center of the CI 
- Width of the CI 


d Now, suppose that that your sample size of____ increased from ____ to _____. What would you expect to change (if anything?)

- Center of the CI 
- Width of the CI 


