---
title: "HW 4 - Scraping + recap"
categories: "Homework"
editor: visual
---

::: callout-important
This homework is due Friday, Nov 2nd at 11:59pm ET.
:::

::: callout-important
Homeworks are to be turned in individually as usual (different from labs)
:::

# Getting started

-   Go to the [sta199-f22-2](https://github.com/sta199-f22-2) organization on GitHub. Click on the repo with the prefix `hw-03`. It contains the starter documents you need to complete the homework assignment.

-   Clone the repo and start a new project in RStudio. See the [Lab 0 instructions](https://sta199-f22-2.github.io/labs/lab-0.html#clone-the-repo-start-new-rstudio-project) for details on cloning a repo and starting a new R project.

## Workflow + formatting

Make sure to

-   Update author name on your document.
-   Label all code chunks informatively and concisely.
-   Follow the [Tidyverse style guide](https://style.tidyverse.org/).
-   Make at least 3 commits.
-   Resize figures where needed, avoid tiny or huge plots.
-   Use informative labels for plot axes, titles, etc.
-   Turn in an organized, well formatted document.

## Packages

We'll use the **tidyverse** package for much of the data wrangling and visualization, though you're welcomed to also load other packages as needed.

```{r}
#| label: load-packages
#| message: false


library(tidyverse)
library(rvest)
library(robotstxt)
library(fivethirtyeight)
```

## Exercise 1 - Data Scraping

(a) Please justify, using the tools we've learning in this course, if you are allowed to scrape data from each of the following websites:

https://www.espn.com/

https://twitter.com/

https://www.rottentomatoes.com

```{r}

# insert-code-here
```


## Exercise 2 - Rotten Tomatoes

Rotten Tomatoes is an American review-aggregation website for film. They give percentage scores for movies based on how "good" the movies are. They provide 2 scores:

![](images/popcornlogos.png) - The Audience Score, denoted by a popcorn bucket

![](images/tomatologos.png) - The Tomatometer score represents the percentage of professional critic reviews that are positive for a given film

(b) We are going to investigate the relationship between the audience score and tomatometer score between the haloween movies. Please visit the following website: https://www.rottentomatoes.com/franchise/halloween

Next, run the following code:

```{r}


page <- read_html("https://www.rottentomatoes.com/franchise/halloween")

titles <- page |>
  html_nodes("#franchise-media a") |>
  html_text2()

titles_clean <- titles[c(FALSE, TRUE)]

titles

titles_clean
```

In 2-3 sentences, describe what the above code is doing. Specifically, how is titles different from titles_clean?

**Add Response**

(c) Using `Selector Gadget`, input the appropriate nodes to scrape the audience score and tomatometerscore from the website.

```{r}
tomato_score <- page |>
  html_nodes("...") |>
  html_text2()

audience_score <- page |>
  html_nodes("...") |>
  html_text2()
```

(d) Create a tibble using the three variables you scraped. Name this tibble `halloween`

(e) Create an appropriate plot the assess the relationship between a movie's audience score and their tomatometerscore. In 2-3 sentences, comment on the relationship. Your plot should include appropriate labels.

## Exercise 3 - The Work of Bob Ross

Bob Ross was a painter who was most famous for his PBS television show The Joy of Painting. In each episode, Ross created a new oil painting and provided instructions and commentary as he painted it. Ambitious viewers could paint along but viewers simply enjoyed watching and listening to Ross's soothing voice as he painted an outdoor scene in 30 minutes.

In 2014, Walt Hickey wrote an article for FiveThirtyEight using statistics to analyze the paintings created on the show.The article focused on features that were often seen in Ross's paintings, such as trees, clouds, cabins, among others. Click here to see the article.

In this assignment, you will analyze the data that was used for the article. The data is in the bob_ross data set in the fivethirtyeight R package. Each observation represents an episode of the TV show. One painting was created in an episode. The analysis will focus on the following variables:

| Variable  | Definition                                                                          |
|:------------------------------------------------|:----------------------|
| conifer   | \(0\) painting has 0 coniferous trees (1) painting has at least one coniferous tree |
| deciduous | \(0\) painting has 0 deciduous trees (1) painting has at least one deciduous tree   |
| guest     | \(0\) show featured Bob Ross (1) show featured guest painter                        |
| tree      | \(0\) painting included no tree (1) painting has at least one tree                  |
| trees     | \(0\) painting had 0 or 1 trees (1) painting has at least two trees                 |

(a) Though Bob Ross created an overwhelming majority of the paintings on the show The Joy of Painting, a guest painter was occasionally featured on the show. What is the probability a randomly selected episode featured a guest painter?

Bob Ross is known for painting "happy little trees", but was he actually more likely to have a tree in this paintings than other artists? To answer this question...

(b) Calculate the probability a painting contained at least one tree conditioned on whether the painting was created by Bob Ross or a guest painter.

(c) Use geom_col to create a visualization of these probabilities. Make the axis labels for the painter "Bob Ross" and "Guest Painter" instead of 0 and 1. Fill in the bars using the color Sap Green (Hex Code #0a3410), a color commonly used in Bob Ross's paintings.

(d) Does your analysis support Bob Ross's reputation of frequently painting "happy little trees"? Briefly explain.

## Exercise 4 - America's Neighborhood Pollster

SurveyUSA interviewed 886 North Carolina adults 09/28/2022 through 10/02/2022. This research was conducted online among a representative cross section of North Carolina adults, selected at random by Lucid Holdings LLC of New Orleans. We will look at the results from the following question: *Are you optimistic or pessimistic about the economic outlook for your family over the next year?*

Responses were broken down into the following categories:

| Variable | Levels                  |
|:---------|:------------------------|
| Age      | 18-49; 50+              |
| Mood     | Optimistic; Pessimistic |

(a) Of the 886 responses, 481 were between the ages of 18-49. Of the individuals that are between 18-49, 237 individuals responded that they were pessimistic. Of the individuals that are 50+, 164 claimed to be optimistic.

Fill in the code below to create a hypothetical two-way table to represent this situation.

```{r}
#| eval: false
data <- tibble( 
  Type = c(),
  Sale = c(),
  values = ()
  )

data |>
  pivot_wider( 
    names_from = ...,
    values_from = ....)
```

(b) Using your table from part a, calculate the probability that a randomly selected individual is 50+ and is pessimistic.

(c) Using your table from part a, calculate the probability that a randomly selected individual is optimistic.

(d) Using your table from part a, calculate the probability that a randomly selected 18-49 aged individual is optimistic.

(e) Create an appropriate visualization to compare the the relationship between `Age` and `Mood`. Your plot should include appropriate labels. Hint: You may have to re manipulate the data into a more usable form.

```{r}

# insert-code - here

```


## Exercise 5 - Candy

```{r}
candy <- read_csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/candy-power-ranking/candy-data.csv")
```

Please see the description of all variables [here](https://github.com/fivethirtyeight/data/blob/master/candy-power-ranking/README.md)

https://blog.albertkuo.me/post/point-shape-options-in-ggplot/

(a) Recreate the following graph:

![](images/plot.png) 

```{r}

#insert-code-here
```

(b) In 2-3 sentences, use the graph in part a to answer the following question: "Are candies with more sugar more expensive? Does this relationship change if it includes chocolate?

## Exercise 6 - Write a function

Suppose you have two types of candy to give out on Haloween; chocolate bars and starbursts. The probability that you give a random trick-or-treater who knocks on your door a chocolate bar is \%50. With this information, create a function that outputs which type of candy bar you will give a trick-or-treater that knocks on your door. Have your function output a table of the number of chocolate bars and number of starbursts given out to 100 trick-or-treaters. i.e., Run your function with a sample of 100 and display the table results.

Hint: The `sample` function may be helpful. See the following: https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/sample


```{r}

#insert-code-here

```




# Wrap up

## Submission

-   Go to <http://www.gradescope.com> and click Log in in the top right corner.
-   Click School Credentials Duke Net ID and log in using your Net ID credentials.
-   Click on your STA 199 course.
-   Click on the assignment, and you'll be prompted to submit it.
-   Mark all the pages associated with exercise. All the pages of your homework should be associated with at least one question (i.e., should be "checked"). If you do not do this, you will be subject to lose points on the assignment.
-   Select the first page of your PDF submission to be associated with the "Workflow & formatting" question.

## Grading

-   Exercise 1: 10 points
-   Exercise 2: 10 points
-   Exercise 3: 10 points
-   Exercise 4: 3 points
-   Exercise 5: 3 points
-   Exercise 6: 10 points
-   Workflow + formatting: 4 points
-   Total: 50 points
